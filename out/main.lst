C51 COMPILER V9.55   MAIN                                                                  04/14/2020 19:15:57 PAGE 1   


C51 COMPILER V9.55, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN c:\Users\Administrator\Documents\Source\MCU\Sdcc-51\.\out\main.obj
COMPILER INVOKED BY: c:\Keil_v5\C51\BIN\C51.exe c:\Users\Administrator\Documents\Source\MCU\Sdcc-51\.\src\main.c SMALL O
                    -MF2 ROM(SMALL) OPTIMIZE(8,SPEED) REGFILE(c:\Users\Administrator\Documents\Source\MCU\Sdcc-51\.\out\main.ORC) INCDIR(d:\S
                    -DK\msc51;c:\Users\Administrator\Documents\Source\MCU\Sdcc-51\.\dependence;c:\Keil_v5\C51\INC) PRINT(c:\Users\Administrat
                    -or\Documents\Source\MCU\Sdcc-51\.\out\main.lst) TABS(2) OBJECT(c:\Users\Administrator\Documents\Source\MCU\Sdcc-51\.\out
                    -\main.obj)

line level    source

   1          #include "STC15Fxxxx.H"
   2          #include "soft_uart.h"
   3          #include <intrins.h>
   4          #include "EEPROM.h"
   5          #include "D:\\SDK\\msc51\\adc.h"
   6          
   7          static int Maxact=3;
   8          
   9          sbit X0 = P1^2;
  10          sbit X1 = P1^3;
  11          sbit X2 = P1^4;
  12          sbit X3 = P1^5;
  13          
  14          sbit Y0 = P3^3;
  15          sbit Y1 = P3^2;
  16          
  17          int Act1(); //大先小后
  18          int Act2(); //仅大
  19          int Act3(); //小大小大
  20          int Act4(); //小大大小
  21          
  22          void AdcInit();
  23          int AdcExcute();
  24          
  25          
  26          
  27          
  28          void  delay_ms(unsigned int ms)
  29          {
  30   1           unsigned int i;
  31   1         do{
  32   2              i = 12000000L / 13000;
  33   2            while(--i)  ;   //14T per loop
  34   2           }while(--ms);
  35   1      }
  36          
  37          u16 result1=0;
  38          u16 result2=0;
  39          u8 act;
  40          u8 n=0;
  41          int i=0;
  42          u8 X3X=1;
  43          int main()
  44          {
  45   1        AdcInit();
  46   1        delay_ms(100);
  47   1        Get_ADC10bitResult(0);
  48   1        delay_ms(100);
  49   1        result1=Get_ADC10bitResult(0);
  50   1        delay_ms(100);
  51   1        Get_ADC10bitResult(1);
C51 COMPILER V9.55   MAIN                                                                  04/14/2020 19:15:57 PAGE 2   

  52   1        delay_ms(100);
  53   1        result2=Get_ADC10bitResult(1);
  54   1        if(result1==1024)
  55   1        {
  56   2          while(1)
  57   2          {
  58   3            delay_ms(200);
  59   3            TxSend(0x99);
  60   3            delay_ms(50);
  61   3            TxSend((u8)result1);
  62   3            delay_ms(50);
  63   3            TxSend((u8)result2);
  64   3          }
  65   2        }
  66   1        if(result2==1024)
  67   1        {
  68   2          while(1)
  69   2          {
  70   3            delay_ms(200);
  71   3            TxSend(0x99);
  72   3            delay_ms(50);
  73   3            TxSend((u8)result1);
  74   3            delay_ms(50);
  75   3            TxSend((u8)result2);
  76   3          }
  77   2        }
  78   1        result1=result1-500;
  79   1        result2=result2-400;
  80   1        EEPROM_read_n(0x0000,&act,1);
  81   1        if(act>Maxact)act=0;
  82   1        P1=0XFF;
  83   1        P3=0XFF;
  84   1        while(1)
  85   1        {
  86   2          if((X1!=0)&&(X2!=0))
  87   2          {
  88   3            if(X0==0)
  89   3            {
  90   4              delay_ms(5);
  91   4              if(X0!=0)break;
  92   4              switch (act)
  93   4              {
  94   5              case 0:
  95   5                Act1();
  96   5                break;
  97   5              case 1:
  98   5                Act2();
  99   5                break;
 100   5              case 2:
 101   5                Act3();
 102   5                break;
 103   5              case 3:
 104   5                Act4();
 105   5                break;
 106   5              default:
 107   5                break;
 108   5              }
 109   4            }
 110   3            if(X3==0)
 111   3            {
 112   4              if(X3X==1)
 113   4              {
C51 COMPILER V9.55   MAIN                                                                  04/14/2020 19:15:57 PAGE 3   

 114   5                act++;
 115   5                if(act>Maxact)act=0;
 116   5                EEPROM_SectorErase(0x00);
 117   5                delay_ms(5);
 118   5                EEPROM_write_n(0x0000,&act,1);
 119   5                delay_ms(5);
 120   5              }
 121   4            }
 122   3          }
 123   2          X3X=X3;
 124   2        }
 125   1      }
 126              
 127              
 128              
 129          int Act1()
 130          {
 131   1        Y0=0;
 132   1        while(1)
 133   1        {
 134   2          if(X1==0)
 135   2          {
 136   3            delay_ms(result1);
 137   3            Y1=0;
 138   3            while(1)
 139   3            {
 140   4              if(X2==0)
 141   4              {
 142   5                delay_ms(result2);
 143   5                Y1=1;
 144   5                delay_ms(30);
 145   5                Y0=1;
 146   5                return 0;
 147   5              }
 148   4            }
 149   3          }
 150   2        }
 151   1      }
 152          
 153          int Act2()
 154          {
 155   1        Y0=0;
 156   1        while(1)
 157   1        {
 158   2          if(X1==0)
 159   2          {
 160   3            delay_ms(result1);
 161   3            Y0=1;
 162   3            while(1)
 163   3            {
 164   4              if(X1==1)
 165   4              {
 166   5                return 0;
 167   5              }
 168   4            }
 169   3          }
 170   2        }
 171   1      }
 172          
 173          int Act3()
 174          {
 175   1        Y1=0;
C51 COMPILER V9.55   MAIN                                                                  04/14/2020 19:15:57 PAGE 4   

 176   1        while(1)
 177   1        {
 178   2          if(X2==0)
 179   2          {
 180   3            delay_ms(result2);
 181   3            Y0=0;
 182   3            while(1)
 183   3            {
 184   4              if(X1==0)
 185   4              {
 186   5                delay_ms(result1);
 187   5                Y1=1;
 188   5                delay_ms(30);
 189   5                Y0=1;
 190   5                while (1)
 191   5                {
 192   6                  if(X1==1&&X2==1)
 193   6                  {
 194   7                    return;
 195   7                  }
 196   6                }
 197   5                
 198   5              }
 199   4            }
 200   3          }
 201   2        }
 202   1      }
 203          
 204          int Act4()
 205          {
 206   1        Y1=0;
 207   1        while(1)
 208   1        {
 209   2          if(X2==0)
 210   2          {
 211   3            delay_ms(result2);
 212   3            Y0=0;
 213   3            while(1)
 214   3            {
 215   4              if(X1==0)
 216   4              {
 217   5                delay_ms(result1);
 218   5                Y0=1;
 219   5                delay_ms(30);
 220   5                Y1=1;
 221   5                while (1)
 222   5                {
 223   6                  if(X1==1&&X2==1)
 224   6                  {
 225   7                    return;
 226   7                  }
 227   6                }
 228   5                
 229   5              }
 230   4            }
 231   3          }
 232   2        }
 233   1      }
 234          
 235          
 236          void AdcInit()
 237          {
C51 COMPILER V9.55   MAIN                                                                  04/14/2020 19:15:57 PAGE 5   

 238   1        P1ASF = ADC_P11 | ADC_P10;
 239   1        ADC_CONTR = (ADC_CONTR & ~ADC_90T) | ADC_360T;
 240   1        ADC_CONTR |= 0x80;
 241   1        CLK_DIV |=  (1<<5); //10位AD结果的高2位放ADC_RES的低2位，低8位在ADC_RESL。
 242   1        EADC = 1;     //中断允许    ENABLE,DISABLE
 243   1        PADC = 1;   //优先级设置 PolityHigh,PolityLow
 244   1        ADC_CONTR |=0x80;
 245   1        delay_ms(200);
 246   1      }
 247          
 248          int AdcExcute()
 249          {
 250   1      
 251   1      }
*** WARNING C290 IN LINE 125 OF c:\Users\Administrator\Documents\Source\MCU\Sdcc-51\.\src\main.c: missing return value
*** WARNING C290 IN LINE 202 OF c:\Users\Administrator\Documents\Source\MCU\Sdcc-51\.\src\main.c: missing return value
*** WARNING C290 IN LINE 233 OF c:\Users\Administrator\Documents\Source\MCU\Sdcc-51\.\src\main.c: missing return value
*** WARNING C290 IN LINE 251 OF c:\Users\Administrator\Documents\Source\MCU\Sdcc-51\.\src\main.c: missing return value


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    492    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     11    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  4 WARNING(S),  0 ERROR(S)
